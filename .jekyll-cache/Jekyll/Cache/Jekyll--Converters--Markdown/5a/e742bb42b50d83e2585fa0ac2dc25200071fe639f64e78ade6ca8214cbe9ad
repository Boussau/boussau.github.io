I"m<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># We simulate a species tree and gene trees and reconstruct a species tree using maximum tree:
# Letâ€™s simulate a species tree with 10 taxa, 5 gene trees, 1 alleles per species:
n_species &lt;- 10
n_genes &lt;- 5
n_alleles &lt;- 2
# we simulate an ultrametric species tree:
# Species names:
for (i in 1:n_species) {
        species[i] &lt;- taxon(taxonName="Species_"+i, speciesName="Species_"+i)
}
spTree ~ dnBirthDeath(lambda=0.3, mu=0.2, rootAge=10, rho=1, samplingStrategy="uniform", condition="nTaxa", taxa=species)
print(spTree)
# let's pick a constant effective population size of 50:
popSize &lt;- 50
# let's simulate gene trees now:
# taxa names:
for (g in 1:n_genes) {
  for (i in 1:n_species) {
    for (j in 1:n_alleles) {
        taxons[g][(i-1)*n_alleles+j] &lt;- taxon(taxonName="Species_"+i, speciesName="Species_"+i)
    }
  }
  geneTrees[g] ~ dnMultiSpeciesCoalescent(speciesTree=spTree, Ne=popSize, taxa=taxons[g])
}
# Let's compute the maximum tree:
recTree &lt;- maximumTree(geneTrees)
print(recTree)
</code></pre></div></div>
:ET