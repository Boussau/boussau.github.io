I"%<p>Some studies, <em>e.g.</em> <a class="citation" href="#Brown2010">Brown et al. (2010), Rannala et al. (2012)</a>,
have criticized the exponential prior distribution for branch lengths
because it induces a gamma-distributed tree-length and the mean of this gamma
distribution grows with the number of taxa. As an alternative, we can instead
use a specific gamma prior distribution (or any other distribution yielding a
positive real variable) for the tree length, and then use a Dirichlet prior
distribution to break the tree length into the corresponding branch lengths
<a class="citation" href="#Zhang2012">(Zhang et al. 2012)</a>.</p>

<p>First, specify a prior distribution on the tree length with your desired mean.
For example, we use a gamma distribution as our prior on the tree length.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TL ~ dnGamma(2,4)
moves.append( mvScale(TL) )
</code></pre></div></div>

<p>Now we create a random variable for the relative branch lengths.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rel_branch_lengths ~ dnDirichlet( rep(1.0,num_branches) )
moves.append( mvBetaSimplex(rel_branch_lengths, weight=num_branches) )
moves.append( mvDirichletSimplex(rel_branch_lengths, weight=num_branches/10.0) )
</code></pre></div></div>
<p>Finally, transform the relative branch lengths into actual branch lengths</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>br_lens := rel_branch_lengths * TL
</code></pre></div></div>
:ET